# 분실물 관리 (Lost & Found)

분실물 관리는 세차 과정에서 발견된 고객의 분실물을 등록, 추적, 처리하는 기능입니다. 옥스트라(Oxtra) 시스템의 '분실물 카드'와 연동하여 고객에게 분실물을 안전하게 인계하는 것을 목표로 합니다.

---

## 1. 데이터 모델 (Data Model)

분실물 정보를 구성하는 데이터 필드는 다음과 같습니다.

| 필드명 (영문) | 필드명 (국문) | 데이터 타입 | 설명 | 수정 가능 |
| :--- | :--- | :--- | :--- | :--- |
| `id` | 분실물 ID | Number | 시스템에서 자동 생성되는 고유 식별자 | 불가 |
| `createdAt` | 접수 일시 | Datetime | 분실물이 시스템에 처음 등록된 시간 | 불가 |
| `itemCategory` | 분실물 구분 | String | '귀중품', '일반' 중 선택 | **가능** |
| `status` | 처리 상태 | String | 아래 [처리 상태](#2-처리-상태-정의) 참조 | **가능** |
| `itemDetails` | 습득물 상세 정보 | String | 습득한 분실물의 구체적인 정보 (예: 검은색 아이폰 13) | **가능** |
| `itemPhotos` | 습득물 사진 | Array | 분실물 사진 URL 목록 | **가능** |
| `carId` | 차량 ID | Number | 분실물이 발견된 차량의 고유 ID | 불가 |
| `carNumber` | 차량 번호 | String | 분실물이 발견된 차량의 번호 | 불가 |
| `zoneId` | 존 ID | Number | 차량이 소속된 존의 고유 ID | 불가 |
| `zoneName` | 존 이름 | String | 존 명칭 (예: 성수 비즈밸리) | 불가 |
| `region1` | 지역 1 | String | 존의 상위 지역 (예: 서울) | 불가 |
| `region2` | 지역 2 | String | 존의 하위 지역 (예: 성동구) | 불가 |
| `partnerId` | 파트너사 ID | Number | 세차를 수행한 파트너사의 고유 ID | 불가 |
| `partnerName` | 파트너사 | String | 파트너사 명칭 | 불가 |
| `relatedOrderId` | 연계 오더 ID | Number | 분실물이 발견된 세차 오더의 ID | **가능** |
| `lostItemCardReceiptNumber` | 분실물 카드 접수 번호 | String | 옥스트라 시스템과 연동되는 접수 번호 | 불가 |
| `deliveryAddress` | 배송 주소 | String | 고객이 요청한 배송지 주소 | **가능** |
| `customerReportedItemDetails` | 고객 신고 물품 정보 | String | 옥스트라에 고객이 신고한 분실 물품의 상세 정보 | 불가 |
| `trackingNumber` | 송장번호 | String | 배송 시 사용된 택배 송장번호 | **가능** |

---

## 2. 처리 상태 정의 (Status Definition)

분실물 처리 상태는 5단계로 관리되며, 각 상태는 데이터 테이블에서 Badge로 시각화됩니다.

**비즈니스 가이드:**
- **'배송지 미입력'** 상태일 때는 **'배송 주소'** 필드가 비어있어야 합니다.
- **'발송 대기'** 이상의 상태(발송 대기, 발송 완료, 폐기 완료, 경찰서인계)가 되려면, 반드시 **'배송 주소'**가 입력되어야 합니다. (단, 폐기/경찰서 인계 시에는 주소 대신 관련 메모가 기입될 수 있습니다.)
- **'발송 완료'** 상태로 변경하려면, 반드시 **'송장번호'** 필드가 입력되어야 합니다.

| 상태명 | UI Badge | 설명 |
| :--- | :--- | :--- |
| **배송지 미입력** | `warn` (황색) | 분실물은 등록되었으나, 고객의 배송지 정보가 아직 입력되지 않은 상태입니다. |
| **발송 대기** | `info` (청색) | 고객의 배송지가 입력되어 발송을 기다리는 상태입니다. |
| **발송 완료** | `ok` (녹색) | 고객에게 분실물 배송이 완료된 상태입니다. |
| **폐기 완료** | `default` (회색) | 보관 기간이 만료되어 규정에 따라 분실물을 폐기한 상태입니다. |
| **경찰서인계** | `default` (회색) | 분실물을 관할 경찰서에 인계한 상태입니다. |

---

## 3. 미션 연동 로직 (Mission Integration)

- 세차 수행 전, 해당 차량(`car_id`)에 고객이 신고한 '분실물 카드'가 옥스트라 시스템에 존재하는 경우, 해당 세차 오더에 **'분실물 수거' 미션이 자동으로 등록**됩니다.
- 핸들러는 이 미션을 확인하고, 세차 시 분실물 수거에 더욱 주의를 기울여야 합니다.

---

## 4. 기능 명세 (Feature Specifications)

### 4.1. 리스트 (DataTable)

- **필터 (Filter)**
  - [분실물 처리 상태] `Select` 필터를 통해 특정 상태의 분실물만 조회할 수 있습니다.

- **컬럼 (Columns)**
  1. **분실물 ID**: `id`
  2. **파트너사**: `partnerName`
  3. **차량 번호**: `carNumber`
  4. **존 이름**: `zoneName`
  5. **오더 ID**: `relatedOrderId` (클릭 시 해당 세차 오더 상세 페이지로 이동)
  6. **접수 일시**: `createdAt`
  7. **분실물 카드 접수 번호**: `lostItemCardReceiptNumber` (값이 없으면 빈 칸으로 표시)
  8. **처리상태**: `status` (Badge 적용)

### 4.2. 상세 조회 및 수정 (Drawer)

- **레이아웃 (Layout)**
  - 상세 정보는 4개의 카드(Card) 섹션으로 그룹화하여 표시합니다.
  - '수정' 버튼 클릭 전에는 모든 정보가 텍스트로 보이며, 클릭 후에만 수정 가능한 필드가 Form 요소로 변경됩니다.

- **카드 섹션 구성**
  1.  **분실물 정보**
      - `분실물 ID` (수정 불가)
      - `접수 일시` (수정 불가)
      - `분실물 구분`: '귀중품' / '일반' 선택 (Select)
      - `처리 상태`: [처리 상태](#2-처리-상태-정의) 목록 선택 (Select)
      - `송장번호`: (Input, '발송 완료' 상태일 때만 활성화 및 표시)
      - `습득물 상세 정보`: (TextArea)
      - `습득물 사진`: 사진 추가/삭제 기능

  2.  **차량 정보**
      - `차량 번호` (수정 불가)
      - `존 이름` (수정 불가)
      - `지역1` (수정 불가)
      - `지역2` (수정 불가)
      - `존 ID` (수정 불가)

  3.  **세차 오더 정보**
      - `파트너사` (수정 불가)
      - `연계 오더 ID`: 수정 시 검색 및 선택 기능 (Mock)

  4.  **분실물 카드 정보 (옥스트라 연동)**
      - `카드 접수 번호` (수정 불가)
      - `배송 주소`: 수정 시 '주소 찾기' 버튼으로 검색 (Mock)
      - `분실한 물품 상세 정보` (수정 불가)

### 4.3. 분실물 수정 (Edit)

- **수정 (Edit)**
    1. 사용자는 리스트에서 항목을 클릭하여 상세 정보 Drawer를 엽니다.
    2. 하단의 '수정' 버튼을 클릭하여 '수정 모드'로 전환합니다.
    3. 수정 가능한 필드(`분실물 구분`, `처리상태`, `송장번호`, `상세 정보`, `사진`, `연계 오더 ID`, `배송 주소`)가 입력 형태로 변경됩니다.
    4. 수정 완료 후 '저장' 버튼을 클릭하면, 데이터가 리스트에 반영되고 "옥스트라 시스템과 정보가 동기화되었습니다"라는 알림이 표시된 후 '조회 모드'로 돌아갑니다.
    5. '취소' 버튼을 클릭하면 모든 변경사항이 취소되고 '조회 모드'로 돌아갑니다.
    6. 분실물 데이터는 삭제되지 않으며, 상태 변경을 통해 관리됩니다.

---

## 5. 기술 가이드 (Tech Guide)

- **컴포넌트 재활용**: 프로젝트 내 기존 `Drawer`, `Card`, `Badge`, `Input`, `Select`, `Button` 컴포넌트를 적극 활용합니다.
- **모킹 (Mocking)**: '주소 찾기' 및 '오더 ID' 검색 기능은 실제 API 연동 없이, 사용자 인터랙션이 가능한 수준의 프로토타입(Alert, Prompt 등)으로 구현합니다.