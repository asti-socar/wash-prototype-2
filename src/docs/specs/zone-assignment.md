# 존 배정 관리 기능 명세서

## 1. 개요
- **화면명**: 존 배정 관리
- **메뉴 위치**: 정보 관리 > 존 배정 관리
- **목적**: 쏘카가 보유한 전체 존을 기준으로 파트너 배정 현황을 관리합니다. 존 중심의 UI를 통해 파트너가 배정되지 않은 존을 빠르게 식별하고 배정할 수 있습니다.
- **주요 기능**: 존 목록 조회, 배정 상태 필터링, 파트너 배정/변경/해제, 대량 존 배정(CSV/Excel 업로드).

## 2. 화면 구성 및 기능

### 2.1 존 배정 목록 (List)
쏘카가 보유한 전체 존을 테이블 형태로 조회합니다.

- **페이지네이션**: 페이지당 **40건** 기준.
- **기본 정렬**: 존 ID **내림차순** (최신 존 우선 표시).
- **정렬**: 헤더 클릭 시 오름차순/내림차순 정렬 지원.
- **필터링**: 지역1, 지역2, 배정 상태 (전체 / 배정 / 미배정)
  - **지역2 필터**: 지역1 선택 전까지 **비활성화**
- **검색**: 존 ID 또는 존 이름 검색.

#### 컬럼 정의
| 헤더명 | 정렬 | 데이터 정의 및 로직 |
| :--- | :---: | :--- |
| **존 ID** | O | Z-1001 형식 |
| **지역1** | O | 시/도 (서울, 경기, 부산 등) |
| **지역2** | O | 구/군/시 (강남구, 성남시 등) |
| **존 이름** | O | 강남역 1번존 등 |
| **존 유형** | O | 현장세차존, 주기세차존, 현장세차 불가존 |
| **차량 대수** | O | 해당 존에 위치한 차량 수 |
| **배정 파트너** | O | 배정된 파트너명 또는 **[배지]** 미배정 표시 |

#### 배정 상태 표시
- **배정**: 파트너명 텍스트 표시 (예: "A파트너")
- **미배정**: `<Badge tone="warn">미배정</Badge>` 배지로 강조

#### 상단 통계
- **전체**: 전체 존 개수
- **배정**: 파트너가 배정된 존 개수 (녹색)
- **미배정**: 파트너가 미배정된 존 개수 (주황색)

### 2.2 존 배정 상세 (Drawer)
목록의 행(Row) 클릭 시 우측 드로어가 열리며, 존 정보를 확인하고 파트너를 배정합니다.

- **타이틀**: `존 배정 상세 - {존ID}` (예: Z-1001)

#### A. 존 정보 섹션
- **존 ID**: Z-1001 형식
- **존 이름**: 강남역 1번존
- **지역**: 지역1 / 지역2 형식 (예: 서울 / 강남구)
- **전체 주소**: 상세 주소
- **존 유형**: 현장세차존, 주기세차존, 현장세차 불가존

#### B. 차량 정보 섹션
- **차량 대수**: 해당 존에 위치한 차량 수

#### C. 파트너 배정 섹션
- **현재 배정 파트너**: 파트너명 표시 (미배정 시 "미배정" 배지)
- **파트너 변경**: Select 드롭다운으로 파트너 선택/변경
  - 옵션: "미배정" + 전체 파트너 목록
- **저장 버튼**: 변경사항 저장

### 2.3 대량 존 배정 (Drawer)
**[대량 존 배정]** 버튼 클릭 시 드로어가 열리며, CSV 또는 엑셀 파일을 통해 다수의 존에 파트너를 일괄 배정합니다.

#### 기능 구성

##### A. 대량 배정 안내
- 파일 형식 및 필수 컬럼 안내
- **[양식 다운로드]** 버튼 제공 (CSV 템플릿)

##### B. 파일 업로드
- **클릭** 또는 **드래그앤드롭**으로 파일 업로드
- 지원 파일 형식: CSV (.csv), Excel (.xlsx, .xls)
- 업로드 후 자동 파싱 및 검증 수행

##### C. 검증 결과 표시
- **배정 가능**: 검증 통과한 건수 및 상세 목록 표시
- **배정 실패**: 실패 사유와 함께 오류 내역 표시
  - 예: "존재하지 않는 존 ID입니다."
  - 예: "존재하지 않는 파트너 ID입니다."

##### D. 배정 적용
- **[N건 배정 적용]** 버튼으로 검증 통과 건 일괄 반영
- 확인 다이얼로그 후 적용 완료

#### CSV 양식
```csv
zoneId,partnerId
Z-1001,P-001
Z-1002,P-002
Z-1003,
```
- **zoneId**: 배정할 존 ID (필수)
- **partnerId**: 배정할 파트너 ID (빈 값 = 미배정 처리)

#### 검증 로직
| 검증 항목 | 실패 시 메시지 |
| :--- | :--- |
| 존 ID 누락 | 존 ID가 비어있습니다. |
| 존재하지 않는 존 ID | 존재하지 않는 존 ID입니다. |
| 존재하지 않는 파트너 ID | 존재하지 않는 파트너 ID입니다. |

---

## 3. 비즈니스 로직

### 3.1 데이터 관계
- **존 → 파트너**: **1:1 관계** (하나의 존에 하나의 파트너만 배정 가능)
- **파트너 → 존**: 1:N 관계 (하나의 파트너가 여러 존 담당 가능)

### 3.2 배정 상태 변경
- **배정**: 미배정 존에 파트너를 선택하여 저장
- **변경**: 이미 배정된 존의 파트너를 다른 파트너로 변경
- **해제**: 배정된 파트너를 "미배정"으로 변경하여 배정 해제

### 3.3 파트너 관리 페이지와의 관계
- 파트너 관리 페이지에서는 **배정 존 개수**만 읽기 전용으로 표시
- 존 배정 변경은 **존 배정 관리 페이지에서만** 가능

---

## 4. 데이터 모델

### 존 배정 데이터 구조
```javascript
{
  zoneId: "Z-1001",           // 존 ID
  zoneName: "강남역 1번존",     // 존 이름
  region1: "서울",            // 지역1 (시/도)
  region2: "강남구",          // 지역2 (구/군/시)
  fullAddress: "서울특별시 강남구 강남대로 396",  // 전체 주소
  zoneType: "현장세차존",      // 존 유형
  operationTime: "24시간",    // 운영 시간
  parkingType: "건물안",       // 주차 유형
  vehicleCount: 18,          // 차량 대수
  assignedPartnerId: "P-001" // 배정 파트너 ID (null = 미배정)
}
```

---

## 5. UI/UX 가이드

### 5.1 필터 연동
- **지역2 비활성화**: 지역1 선택 전까지 지역2 필터는 비활성화 상태
- **지역1 선택 시**: 지역2 활성화 및 해당 지역1에 속한 지역2만 옵션 표시
- **지역1 변경 시**: 지역2 필터 자동 초기화

### 5.2 미배정 존 강조
- 배정 파트너 컬럼에서 미배정 존은 `<Badge tone="warn">미배정</Badge>` 배지로 시각적 강조
- 배정 상태 필터에서 "미배정" 선택 시 빠르게 미배정 존만 조회 가능

### 5.3 드로어 저장 버튼
- 변경사항이 없으면 저장 버튼 비활성화 (disabled)
- 변경사항이 있으면 저장 버튼 활성화
