# 오더 관리 기능 명세서

## 1. 개요
- **화면명**: 오더 관리
- **목적**: 세차 오더의 전체 생명주기(발행, 배정, 수행, 완료)를 관리하고 상세 정보를 모니터링합니다.
- **주요 기능**: 오더 목록 조회/필터링, 수기 오더 발행, 오더 상세 정보 및 타임라인 확인, 오더 수행 완료/삭제 처리.

## 2. 화면 구성 및 기능

### 2.1 검색 및 필터 (Search & Filter)
상단 카드 영역에서 데이터를 필터링하며, 선택된 조건은 하단에 **칩(Chip)** 형태로 노출됩니다.

#### 검색 조건
| 구분 | 항목 | 타입 | 동작 정의 |
| :--- | :--- | :--- | :--- |
| **검색** | 검색항목 | 선택(Select) | **옵션**: 차량번호(Default), 오더 ID, 존이름, 수행원 |
| **검색** | 검색어 | 입력(Input) | 선택한 항목에 해당하는 텍스트 부분 일치 검색 |
| **기간** | 발행일 | DatePicker | 시작일 ~ 종료일 범위 조회 (기본값: 최근 7일) |
| **필터** | 지역1 | 선택(Select) | 변경 시 하위 **'지역2' 값 초기화** |
| **필터** | 지역2 | 선택(Select) | 선택된 지역1에 속한 지역만 노출 |
| **필터** | 오더 구분 | 선택(Select) | 긴급, 정규, 변경, 수시, 특별 |
| **필터** | 오더 유형 | 선택(Select) | 위생장애, 주기세차, 수시세차 등 |
| **필터** | 세차 유형 | 선택(Select) | 내외부, 내부, 외부, 특수 등 |
| **필터** | 파트너명 | 선택(Select) | 파트너사 이름 기준 |
| **필터** | 파트너 유형 | 선택(Select) | **[동적 로직]**<br>- 옵션: 전체, 현장, 입고<br>- 변경 시 **'진행 상태'** 필터의 옵션 목록이 해당 유형에 맞게 갱신됨.<br>*(예: 현장 선택 시 '입고 중', '출고 중' 상태 제외)* |
| **필터** | 진행 상태 | 선택(Select) | 미배정, 예약, 수행 중, 완료, 취소 등 |

#### UI 동작
- **칩(Chip)**: 적용된 필터 조건이 칩으로 나열되며, `X` 버튼 클릭 시 해당 조건만 개별 초기화.
- **초기화 버튼**: 클릭 시 검색어, 기간(최근 7일), 모든 필터 조건을 초기화하고 목록 갱신.
- **퀵 필터**: 외부(Props)에서 `quickStatus` 전달 시, 해당 상태값이 필터에 자동 적용됨.

### 2.2 오더 목록 (List)
- **페이지네이션**: 페이지당 **40건** 기준.
- **정렬**: 헤더 클릭 시 오름차순/내림차순 정렬.
- **다운로드**: '목록 다운로드' 버튼 제공 (UI 구현).

#### 컬럼 정의
| 헤더명 | 정렬 | 데이터 정의 및 로직 |
| :--- | :--- | :--- |
| **오더 ID** | O | |
| **오더구분** | O | |
| **오더유형** | O | |
| **세차유형** | O | |
| **차량 ID** | O | |
| **차종** | O | |
| **차량번호** | O | |
| **지역1/지역2** | O | |
| **존이름** | O | |
| **파트너명** | O | |
| **파트너유형** | O | 현장 / 입고 |
| **진행상태** | O | 상태별 색상 **배지(Badge)** 적용<br>*(예: 완료-Green, 미배정-Red, 예약-Orange)* |
| **수행원** | O | |
| **발행일시** | O | `YYYY-MM-DD HH:mm` 형식 |
| **수행일시** | - | 상태가 [수행 중, 세차 완료, 출고 중, 완료]일 때만 노출. 그 외 `-` 표기 |

### 2.3 오더 수동 발행 (Drawer)
'오더 발행' 버튼(+) 클릭 시 우측에서 드로어가 열립니다.

- **차량 조회 로직**:
  - 차량번호 입력 시, 등록된 차량 정보를 실시간으로 조회하여 **차종, 존이름, 파트너명**을 자동 표기합니다.
  - 일치하는 차량이 없을 경우 경고 메시지를 노출합니다.
- **미션 자동 연동**:
  - 입력된 차량번호에 **대기(Pending) 상태의 미션**이 존재할 경우, 오더 생성 시 자동으로 포함(Link)됩니다.
- **생성 값 정의**:
  - 파트너 유형은 **"현장"**으로 고정 생성됩니다.
  - 초기 상태는 **"예약"**으로 생성됩니다.

### 2.4 오더 상세 (Drawer)
목록의 행(Row) 클릭 시 우측 드로어가 열리며, **탭(Tab)** 구조로 상세 정보를 제공합니다.

#### 공통 액션 (Footer)
- **수행 완료**: 상태가 [완료, 취소]가 아닐 때 노출. 클릭 시 오더 및 연결된 미션을 '완료' 처리.
- **오더 삭제**: '오더 삭제' 버튼 클릭 시 사유 입력 **모달(Modal)** 호출. 사유 입력 후 삭제 확정.

#### 탭 구성

**1. 상세정보 (Tab)**
- **기본 정보**: 오더ID(배지 포함), 차량번호, 차종, 존 정보, 지역, 오더/세차/파트너 유형, 수행원, 상태, 메모.
- **시간 정보**: 발행일시, 수행일시(조건부 노출).
- **금액 및 연계**: 최종 청구 금액, 연계된 부모 오더(입고 파트너 유형인 경우) 링크.

**2. 사진 및 이력 (Tab)**
- **진행 이력 (Timeline)**: 파트너 유형에 따라 단계가 다르게 노출됨.
  - **입고**: 미배정 > 파트너 배정 > 예약 > 입고 중 > 수행 중 > 세차 완료 > 출고 중 > 완료
  - **현장**: 미배정 > 예약 > 수행 중 > 완료
- **수행 사진**: 수행 전/후 사진 그리드. 클릭 시 **이미지 프리뷰 모달** 팝업.
- **점검 리스트**: 외관, 휠, 실내 등 점검 항목의 Pass 여부 표시.

**3. 미션 및 분실물 (Tab)**
- **미션**: 오더에 할당된 미션 내용 및 상태(완료 여부) 리스트. 없으면 "없음" 문구 노출.
- **분실물**: 습득된 분실물 명, 보관 상태, 습득 장소/일시 표시.