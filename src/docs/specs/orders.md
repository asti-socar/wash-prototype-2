# 오더 관리

## 1. 개요
- **화면명**: 오더 관리
- **목적**: 세차 오더의 전체 생명주기 관리(발행, 배정, 수행, 완료) 및 특수 미션/이슈 관제.
- **주요 기능**: 오더 목록 조회/필터링, 수기 오더 발행, 미션 등록, 상세 정보(타임라인, 사진, 점검) 확인.

## 2. 기능 명세

### 2.1 검색 및 필터
다양한 조건으로 오더를 조회할 수 있습니다.

| 구분 | 필드명 | 타입 | 설명 및 로직 |
| :--- | :--- | :--- | :--- |
| **검색** | 통합 검색 | Input | **대상 필드 (OR 조건)**:<br>- 차량번호<br>- 오더 ID<br>- 존 ID / 존 이름<br>- 수행원<br>- 코멘트 |
| **기간** | 기간 조회 | DatePicker | 생성일 기준 시작일 ~ 종료일 범위 조회 |
| **필터** | 지역 | Select | 지역1, 지역2 (계층형 구조) |
| **필터** | 오더 구분 | Select | 긴급, 정규, 변경, 수시, 특별 |
| **필터** | 오더 유형 | Select | 위생장애, 주기세차, 수시세차, 특수세차 등 |
| **필터** | 세차 타입 | Select | 내외부, 특수, 라이트, 내부, 외부, 물세차, 협의 |
| **필터** | 파트너명 | Select | 파트너명 필드 기준 |
| **필터** | 진행 상태 | Select | 미배정, 파트너 배정, 예약, 입고 중, 수행 중, 세차 완료, 출고 중, 완료, 취소 |

### 2.2 오더 목록
- **데이터 소스**: 확인 가능
- **행 식별자**: 확인 가능

#### 컬럼 정의
| 헤더명 | 비고 |
| :--- | :--- |
| **오더 ID** | |
| **세차타입** | |
| **오더구분** | |
| **오더유형** | |
| **차량 ID** | |
| **차종** | |
| **차량번호** | |
| **존이름** | |
| **세차경과일** | |
| **파트너명** | |
| **파트너유형** | 입고 또는 현장 |
| **진행상태** | 상태별 배지 색상 적용 |

### 2.3 오더 발행 및 미션

#### 수기 오더 발행
- **트리거**: '오더 발행' 버튼
- **입력 필드**:
  - 차량번호 *필수
  - 차종
  - 존이름 *필수
  - 세차 타입
- **생성 로직**:
  - 오더 구분: "수시", 오더 유형: "수시세차", 파트너 유형: "현장"으로 고정 생성.
- **미션 연동**: 입력된 차량번호에 해당하는 대기 상태의 미션이 있을 경우, 자동으로 오더의 미션 목록에 포함됨.

#### 미션 등록
- **트리거**: '미션 등록' 버튼
- **입력 필드**: 대상 차량번호, 미션 내용
- **로직**:
  - 신규 미션은 '대기' 상태로 등록됨.
  - 오더 수행 완료 시, 해당 오더에 포함된 미션들의 상태가 '완료'로 변경되어 다음 오더 생성 시 제외됨.

### 2.4 오더 상세
오더 클릭 시 우측 Drawer에서 탭(Tab) 구조로 상세 정보를 제공합니다.

#### 탭 구성
1. **상세정보**
   - **기본 정보**: 오더 ID, 오더 구분/유형, 차량 정보, 존, 파트너 유형, 수행원, 상태, 메모 등.
   - **금액/연계**: 최종 청구 금액, 연계 오더(Parent Order) 링크.

2. **사진 및 이력**
   - **진행 이력**: 파트너 유형에 따라 다른 단계 노출.
     - **입고**: 미배정 -> 파트너 배정 -> 예약 -> 입고 중 -> 수행 중 -> 세차 완료 -> 출고 중 -> 완료
     - **현장**: 미배정 -> 예약 -> 수행 중 -> 완료
   - **수행 사진**: 수행 전/후 사진 그리드 (클릭 시 확대).
   - **점검 리스트**: 외관, 휠/타이어, 실내, 쓰레기 수거 등 통과/실패 체크.

3. **미션 및 분실물**
   - **미션**: 오더에 할당된 특별 미션 목록 및 수행 상태.
   - **분실물**: 습득된 분실물 정보 (습득물 명, 보관 상태, 습득 장소).