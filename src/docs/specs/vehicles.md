# 차량 관리 기능 명세서

## 1. 개요
- **화면명**: 차량 관리
- **목적**
  - **수행률 모니터링**: 오더 발행 대비 실제 수행 여부를 확인하고, 수행률이 낮은 차량 및 존별 현황을 집중 모니터링합니다.
  - **운영 계획 수립**: 존별 차량 보유 대수 데이터를 제공하여, 파트너사가 적정 수행 인원을 배정할 수 있도록 지원합니다.
- **주요 기능**: 차량 목록 조회, 다차원 검색 및 필터링, 차량 상세 정보 조회, 세차 이력 조회, 엑셀 다운로드.

## 2. 화면 구성 및 기능

### 2.1 검색 및 필터 (Search & Filter)
상단 영역에서 리스트 데이터를 필터링합니다. 선택된 조건은 하단에 **칩(Chip)** 형태로 노출되어야 합니다.

| 구분 | 항목 | 타입 | 동작 정의 |
| :--- | :--- | :--- | :--- |
| **검색** | 검색항목 | 선택(Select) | **옵션**: 차량 번호(Default), 존 이름, 존 ID |
| **검색** | 검색어 | 입력(Input) | 선택한 '검색항목'에 해당하는 텍스트 검색 (부분 일치) |
| **필터** | 지역1 | 선택(Select) | 상위 지역(Region1) 선택. <br>※ **변경 시 하위 필터인 '지역2' 값은 초기화** 처리. |
| **필터** | 지역2 | 선택(Select) | 선택된 '지역1'에 귀속된 하위 지역(Region2) 목록만 노출. |
| **필터** | 파트너 명 | 선택(Select) | 파트너사 이름 기준 필터링. |
| **UI 동작** | 필터 칩 | UI 요소 | 사용자가 적용한 검색어 및 필터 값을 칩 형태로 나열.<br>칩의 `X` 버튼 클릭 시 해당 조건만 개별 삭제 후 리스트 갱신. |
| **초기화** | 필터 초기화 | 버튼 | 모든 검색어 및 필터 조건을 초기화하고 전체 목록을 조회. |

### 2.2 차량 목록 (Vehicle List)
검색 조건에 맞는 차량 목록을 테이블로 표시합니다.

- **데이터 노출**: 페이지당 **40건** 기준 (Pagination).
- **정렬(Sort)**: 테이블 헤더 클릭 시 오름차순/내림차순 정렬 기능 지원.
- **다운로드**: 현재 조회된 목록(필터 적용 결과)을 엑셀 파일로 다운로드.

#### 컬럼 정의
| 헤더명 | 정렬 | 데이터 정의 및 로직 |
| :--- | :--- | :--- |
| **차량 번호** | O | |
| **존 이름** | O | |
| **존 ID** | O | |
| **지역1** | O | |
| **지역2** | O | |
| **파트너 명** | O | |
| **발행된 오더** | O | **[표기 규칙]**<br>1. 발행된 오더가 **있는** 경우: `{오더ID} ({상태값})` 형태로 표시 (예: O-1234 (예약))<br>2. 발행된 오더가 **없는** 경우: `-` 또는 빈 값 처리<br>3. **링크**: 오더 ID 영역 클릭 시, 해당 오더 상세 페이지(새 창)로 이동 |
| **마지막 세차일** | O | `YYYY-MM-DD` 형식 |
| **세차 경과일** | O | `오늘 날짜 - 마지막 세차일` (일 단위 계산) |

### 2.3 차량 상세 (Drawer)
목록의 행(Row)을 클릭하면 우측에서 상세 정보 드로어(Drawer)가 열립니다.

- **UI UX**: 드로어 영역의 너비는 사용자가 마우스 드래그로 조절 가능해야 합니다.
- **타이틀**: 차량 상세 - {차량 번호}

#### A. 기본 정보 섹션
선택한 차량의 마스터 정보를 표시합니다.
- **차량 번호**
- **차종**
- **존 정보**: {존 이름} ({존 ID})
- **지역 정보**: {지역1} / {지역2}
- **파트너 명**
- **발행된 오더**: 목록과 동일한 로직으로 표시 (ID 및 상태값 노출)
- **세차 현황**: 마지막 세차일, 세차 경과일

#### B. 세차 이력 섹션
해당 차량의 과거 세차 수행 이력을 리스트로 표시합니다.
- **구성 항목**: 날짜, 세차 타입(라이트/수시/주기 등), 완료 상태.
- **이동**: 각 이력 항목 클릭 시, 해당 건의 오더 상세 페이지(새 창)로 이동.

## 3. 데이터 정책 및 비즈니스 로직

### 3.1 발행된 오더 판단 기준
- 차량에 매핑된 최신 오더 중, 상태가 **[완료] 혹은 [취소]**가 아닌 경우를 '진행중'으로 간주합니다.
- UI에는 해당 오더의 **ID**와 현재 **진행 상태**(예: 예약, 미배정, 입고 중 등)를 함께 노출하여 진행 단계를 파악할 수 있어야 합니다.

### 3.2 세차 경과일 계산
- **공식**: `Current Date - Last Wash Date` (Day 단위)
- 기준 시간은 클라이언트(브라우저) 시간이 아닌, 서버 시간을 기준으로 계산함을 원칙으로 합니다.

### 3.3 세차 대상 및 노출 기준
- **대상 차량**: `sharing_type`이 **[단기(socar), 시승(testdrive)]**인 차량만 목록에 노출합니다.